services:
  ######################################################
  # R Core
  ######################################################
  r-core:
    image: r/core/mlr3:4.0.2
    build:
      context: ./
      dockerfile: ./.app/docker/r-core/Dockerfile
      args:
        - R_REPOS='https://mran.microsoft.com/snapshot/2020-09-15'
    container_name: r_core
    entrypoint: '/bin/bash'
    restart: "no"
  ######################################################
  # R Development
  ######################################################
  r-develop:
    image: r/core/mlr3:4.0.2
    build:
      context: ./
      dockerfile: ./.app/docker/r-core/Dockerfile
      args:
        - R_REPOS='https://mran.microsoft.com/snapshot/2020-09-15'
    container_name: r_develop
    entrypoint: '/init'
    volumes:
      - ".:/home/rstudio/rproject/"
    ports:
      - 8787:8787
    restart: "no"
  ######################################################
  # R Testing
  ######################################################
  r-test:
    image: r/test/mlr3:4.0.2
    build:
      context: ./
      dockerfile: ./.app/docker/r-testing/Dockerfile
    entrypoint: '/bin/bash'
    container_name: r_test
    restart: "no"
    depends_on:
      - r-core
  ######################################################
version: "3.8"
networks:
  default:
    name: r-project
